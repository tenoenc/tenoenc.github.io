---
layout: post
title: "[System Design] Layeredì—ì„œ Vertical Sliceê¹Œì§€"
date: 2026-01-04 22:18 +0900
categories:
- Backend Engineering
- System Design
tags:
- System Design
- Layered Architecture
- Hexagonal Architecture
- Vertical Slice
- ArchUnit
image:
  path: /assets/img/2026-01-05-02-10-54.png
---

ìš°ë¦¬ëŠ” í”íˆ ì•„í‚¤í…ì²˜ë¥¼ ë…¼í•  ë•Œ ëª¨ë†€ë¦¬ì‹ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì™€ ê°™ì€ ë°°í¬ êµ¬ì¡°ë¥¼ ë– ì˜¬ë¦½ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ ê¸€ì—ì„œëŠ” ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ ë‚´ì˜ ì½”ë“œ ì¡°ì§í™”(Internal Structure)ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.

ë‚´ë¶€ ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ ëª©í‘œëŠ” í™”ë ¤í•œ íŒ¨í„´ ì ìš©ì´ ì•„ë‹™ë‹ˆë‹¤. ê°œë°œìê°€ ì½”ë“œë¥¼ ì½ì„ ë•Œ ê²ªëŠ” ì¸ì§€ ë¶€í•˜(Cognitive Load)ë¥¼ ì¤„ì´ê³ , ê´€ë ¨ëœ ë¡œì§ì„ ì–¼ë§ˆë‚˜ ê°€ê¹ê²Œ ë‘ëŠëƒ í•˜ëŠ” ì‘ì§‘ë„(Cohesion)ë¥¼ ë†’ì´ëŠ” ì‹¸ì›€ì…ë‹ˆë‹¤.

## ğŸ§© Layered Architecture

ì—”í„°í”„ë¼ì´ì¦ˆ ìë°” ìƒíƒœê³„ì—ì„œ Layered Architecture(N-Tier)ëŠ” ê³µê¸°ì²˜ëŸ¼ ìì—°ìŠ¤ëŸ¬ìš´ ì¡´ì¬ì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ, ê³ ë¯¼ ì—†ì´ `controller`, `service`, `repository` íŒ¨í‚¤ì§€ë¥¼ ë§Œë“­ë‹ˆë‹¤. ì•„í‚¤í…ì²˜ ì „ë¬¸ê°€ ë§ˆí¬ ë¦¬ì°¨ì¦ˆ(Mark Richards)ëŠ” ì´ë¥¼ ë‘ê³  "ì‚¬ì‹¤ìƒì˜ í‘œì¤€"ì´ë¼ ì¹­í–ˆìŠµë‹ˆë‹¤. ê°€ì¥ ìµìˆ™í•˜ê³ , íŒ€ì˜ ì¡°ì§ êµ¬ì¡°(í”„ë¡ íŠ¸ì—”ë“œ/ë°±ì—”ë“œ/DBA)ì™€ ì •í™•íˆ ì¼ì¹˜í•˜ë©°, ë¬´ì—‡ë³´ë‹¤ ë¹ ë¥´ê²Œ ì‹œì‘í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì—¬ê¸°ì—ëŠ” ì¹˜ëª…ì ì¸ ë‹¨ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

### ê´€ì‹¬ ë²”ìœ„ì˜ ì¶•ì†Œ

ìš°ë¦¬ëŠ” ì™œ ê³„ì¸µì„ ë‚˜ëˆŒê¹Œìš”? í”íˆ "ë‚˜ì¤‘ì— ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì˜¤ë¼í´ì—ì„œ MySQLë¡œ ì‰½ê²Œ ë°”ê¾¸ê¸° ìœ„í•´ì„œ"ë¼ê³  ë‹µí•˜ì§€ë§Œ, ë§ˆí‹´ íŒŒìš¸ëŸ¬(Martin Fowler)ì˜ í†µì°°ì€ ë‹¤ë¦…ë‹ˆë‹¤. ê·¸ëŠ” ê³„ì¸µí™”ì˜ ë³¸ì§ˆì ì¸ ê°€ì¹˜ë¥¼ "ê´€ì‹¬ ë²”ìœ„ì˜ ì¶•ì†Œ"ë¼ê³  ì •ì˜í–ˆìŠµë‹ˆë‹¤.
- UI ì½”ë“œë¥¼ ì‘ì„±í•  ë•ŒëŠ” ë³µì¡í•œ SQL ì¡°ì¸ ì¿¼ë¦¬ë¥¼ ê³ ë¯¼í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ êµ¬í˜„í•  ë•ŒëŠ” ì´ê²ƒì´ JSONìœ¼ë¡œ ë‚˜ê°ˆì§€ HTMLë¡œ ë Œë”ë§ë ì§€ ì‹ ê²½ ì“°ì§€ ì•ŠëŠ”ë‹¤.

ì¦‰, ê°œë°œìê°€ í•œ ë²ˆì— ë‹¤ë¤„ì•¼ í•  ì¸ì§€ ë¶€í•˜ë¥¼ ì¤„ì—¬ì£¼ê³ , í•œ ë²ˆì— í•˜ë‚˜ì˜ ë¬¸ì œì—ë§Œ ì§‘ì¤‘í•˜ê²Œ ë§Œë“œëŠ” ê²ƒì´ ì´ ì•„í‚¤í…ì²˜ì˜ ì¡´ì¬ ì˜ì˜ì…ë‹ˆë‹¤.

### ë°ì´í„°ë² ì´ìŠ¤ ì£¼ë„ ê°œë°œ

í•˜ì§€ë§Œ í˜„ì‹¤ì˜ Layered ArchitectureëŠ” ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ì‘ë™í•©ë‹ˆë‹¤. ì˜ì¡´ì„±ì˜ íë¦„ì´ ìƒìœ„(Presentation)ì—ì„œ í•˜ìœ„(Persistence)ë¡œ íë¥´ê¸° ë•Œë¬¸ì—, í•„ì—°ì ìœ¼ë¡œ ìµœí•˜ë‹¨ì— ìœ„ì¹˜í•œ ë°ì´í„°ë² ì´ìŠ¤ê°€ ì‹œìŠ¤í…œì˜ ì¤‘ì‹¬ì´ ë©ë‹ˆë‹¤.

ìš°ë¦¬ì˜ ê°œë°œ í”„ë¡œì„¸ìŠ¤ë¥¼ ëƒ‰ì •í•˜ê²Œ ë˜ëŒì•„ë´…ì‹œë‹¤.
1. ERD ì„¤ê³„: í™”ì´íŠ¸ë³´ë“œì— í…Œì´ë¸”ê³¼ ê´€ê³„ë¥¼ ë¨¼ì € ê·¸ë¦½ë‹ˆë‹¤.
2. Entity ìƒì„±: í…Œì´ë¸”ê³¼ 1:1ë¡œ ë§¤í•‘ë˜ëŠ” `Entity` í´ë˜ìŠ¤ë¥¼ ë§Œë“­ë‹ˆë‹¤.
3. CRUD êµ¬í˜„: ê·¸ `Entity`ë¥¼ ì½ê³  ì“°ëŠ” `Repository`, `Service`, `Controller`ë¥¼ ê¸°ê³„ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

ì´ ê³¼ì •ì—ì„œ ê°ì²´ì§€í–¥ì˜ í•µì‹¬ì¸ ê°ì²´ ê°„ì˜ í˜‘ë ¥ê³¼ í–‰ìœ„ëŠ” ì„¤ ìë¦¬ë¥¼ ìƒìŠµë‹ˆë‹¤. ëŒ€ì‹  Getter/Setterë¡œ ì ì² ëœ ë¹ˆí˜ˆ ë„ë©”ì¸ ëª¨ë¸(Anemic Domain Model)ë§Œì´ ë‚¨ê²Œ ë©ë‹ˆë‹¤.

ê²°êµ­ `Service` ê³„ì¸µì€ ë„ë©”ì¸ ë¡œì§ì„ í’ˆì€ ê°ì²´ê°€ ì•„ë‹ˆë¼, ë‹¨ìˆœíˆ ë°ì´í„°ë¥¼ êº¼ë‚´ì„œ ê°€ê³µí•˜ê³  ë‹¤ì‹œ ë„£ëŠ” ì ˆì°¨ì§€í–¥ì ì¸ íŠ¸ëœì­ì…˜ ìŠ¤í¬ë¦½íŠ¸(Transaction Script)ì˜ ì§‘í•©ì†Œë¡œ ì „ë½í•©ë‹ˆë‹¤. ê²©ë¦¬ë¥¼ ìœ„í•´ ë ˆì´ì–´ë¥¼ ë‚˜ëˆ´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” DB ìŠ¤í‚¤ë§ˆê°€ ë³€ê²½ë˜ë©´ `Service`ì™€ `Controller`ê°€ ì¤„ì¤„ì´ ê¹¨ì§€ëŠ” ê°•í•œ ë…¼ë¦¬ì  ê²°í•© ìƒíƒœì— ë¹ ì§€ëŠ” ê²ƒì…ë‹ˆë‹¤.

### Anti-Pattern: ì•„í‚¤í…ì²˜ ì‹±í¬í™€

ì´ ì•„í‚¤í…ì²˜ì˜ ì‹¤íŒ¨ë¥¼ ê°€ì¥ ê·¹ëª…í•˜ê²Œ ë³´ì—¬ì£¼ëŠ” ì¦ê±°ëŠ” ì•„í‚¤í…ì²˜ ì‹±í¬í™€(Architecture Sinkhole) í˜„ìƒì…ë‹ˆë‹¤. ìš”ì²­ì´ ë ˆì´ì–´ë¥¼ í†µê³¼í•˜ë©´ì„œ ì–´ë– í•œ ë¹„ì¦ˆë‹ˆìŠ¤ì  ê°€ì¹˜ë„ ë”í•˜ì§€ ëª»í•˜ê³ , ë‹¨ìˆœíˆ í•˜ìœ„ ë ˆì´ì–´ë¡œ ë„˜ê¸°ê¸°(Pass-through)ë§Œ í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.

```java
@Service
@RequiredArgsConstructor
public class ProductService {
    private final ProductRepository productRepository;

    @Transactional(readOnly = true)
    public ProductDto getProduct(Long id) {
        return productRepository.findById(id)
                .map(Product::toDto)
                .orElseThrow(() -> new EntityNotFoundException());
    }
}
```

ìœ„ ì½”ë“œì—ì„œ ì„œë¹„ìŠ¤ê°€ í•˜ëŠ” ì¼ì´ ì—†ìŠµë‹ˆë‹¤. ê·¸ëƒ¥ `Repository`ì˜ `Proxy`ì¼ ë¿ì…ë‹ˆë‹¤.

> ë§ˆí¬ ë¦¬ì°¨ì¦ˆëŠ” "ì „ì²´ ìš”ì²­ì˜ 20% ì •ë„ëŠ” í—ˆìš©ë˜ì§€ë§Œ, 80% ì´ìƒì´ ì‹±í¬í™€ì´ë¼ë©´ ì´ ì•„í‚¤í…ì²˜ëŠ” ì˜ëª»ëœ ì„ íƒ"ì´ë¼ê³  ê²½ê³ í•©ë‹ˆë‹¤.
{: .prompt-warning }

ìš°ë¦¬ëŠ” ë‹¨ìˆœíˆ ë ˆì´ì–´ë¥¼ ìœ„í•œ ë ˆì´ì–´ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•œ ê°ì²´ ë³€í™˜ ë¹„ìš©, ì»´íŒŒì¼ ë¹„ìš©, ê·¸ë¦¬ê³  ê´€ë¦¬ ë¹„ìš©ì„ ì§€ë¶ˆí•˜ê³  ìˆëŠ” ì…ˆì…ë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ "í‘œì¤€"ì´ë¼ëŠ” ì´ë¦„ ì•„ë˜ ìš°ë¦¬ê°€ ê°„ê³¼í•´ì˜¨ ë¹„íš¨ìœ¨ì˜ ì‹¤ì²´ì…ë‹ˆë‹¤.

## ğŸ§© Hexagonal Architecture

![](/assets/img/2026-01-05-02-39-45.png)

Layered ì•„í‚¤í…ì²˜ê°€ ê°€ì§„ íƒœìƒì ì¸ í•œê³„ëŠ” ì˜ì¡´ì„±ì˜ ë°©í–¥ì…ë‹ˆë‹¤. ìƒìœ„ ê³„ì¸µì´ í•˜ìœ„ ê³„ì¸µì— ì˜ì¡´í•˜ëŠ” êµ¬ì¡° íƒ“ì—, ìš°ë¦¬ì˜ ì†Œì¤‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ í•„ì—°ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ê¸°ìˆ (JPA, MyBatis ë“±)ì— ì˜¤ì—¼ë©ë‹ˆë‹¤.

ì•¨ë¦¬ìŠ¤í…Œì–´ ì½•ë²ˆ(Alistair Cockburn)ì€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì•„í‚¤í…ì²˜ì˜ ìœ„ì•„ë˜ë¥¼ ë’¤ì§‘ì—ˆìŠµë‹ˆë‹¤. ë°”ë¡œ Hexagonal Architectureì´ë©°, Ports and Adaptersë¼ê³ ë„ í•©ë‹ˆë‹¤.

### ì˜ì¡´ì„± ì—­ì „

ì´ ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ ì² í•™ì€ "ë‚´ë¶€ì™€ ì™¸ë¶€ì˜ ì² ì €í•œ ê²©ë¦¬"ì…ë‹ˆë‹¤.
- Inside (Domain Hexagon): ìˆœìˆ˜í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìœ„ì¹˜í•©ë‹ˆë‹¤. ì´ê³³ì€ ì™¸ë¶€ì˜ ì–´ë–¤ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ë„ ì•Œì§€ ëª»í•˜ë©°, í”„ë ˆì„ì›Œí¬ì—ë„ ì˜ì¡´í•˜ì§€ ì•ŠëŠ” POJO(Plain Old Java Object) ìƒíƒœë¥¼ ìœ ì§€í•œë‹¤.
- Outside (Infrastructure): ì›¹ ë¸Œë¼ìš°ì €, ë°ì´í„°ë² ì´ìŠ¤, ì™¸ë¶€ API, ë©”ì‹œì§€ í ë“± ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë‘˜ëŸ¬ì‹¼ ëª¨ë“  ê¸°ìˆ ì  ìš”ì†Œì´ë‹¤.

ì—¬ê¸°ì„œ ì˜ì¡´ì„± ì—­ì „(DIP)ì´ ì¼ì–´ë‚©ë‹ˆë‹¤. ì „í†µì ì¸ ë°©ì‹ì´ë¼ë©´ `Service`ê°€ `Repository` êµ¬í˜„ì²´ë¥¼ ì§ì ‘ ì˜ì¡´í–ˆê² ì§€ë§Œ, í—¥ì‚¬ê³ ë‚ ì—ì„œëŠ” ë„ë©”ì¸ì´ í¬íŠ¸(Port)ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•˜ê³ , ì¸í”„ë¼ ê³„ì¸µì´ ì–´ëŒ‘í„°(Adapter)ë¥¼ í†µí•´ ì´ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. ì¦‰, ì˜ì¡´ì„±ì˜ í™”ì‚´í‘œê°€ ëª¨ë‘ ë°”ê¹¥ì—ì„œ ì•ˆìª½ìœ¼ë¡œ í–¥í•˜ê²Œ ë©ë‹ˆë‹¤.

> **Why Hexagon? (ì™œ ìœ¡ê°í˜•ì¸ê°€?)**
> 
> ì½•ë²ˆì€ "ìœ¡ê°í˜•"ì´ë¼ëŠ” ëª¨ì–‘ ìì²´ì—ëŠ” í° ì˜ë¯¸ê°€ ì—†ë‹¤ê³  ë§í•©ë‹ˆë‹¤. ë‹¨ì§€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ 4ë©´(Top-Down)ë¿ë§Œ ì•„ë‹ˆë¼ ì—¬ëŸ¬ ë©´(Port)ì„ í†µí•´ ì™¸ë¶€ì™€ ì†Œí†µí•  ìˆ˜ ìˆìŒì„ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•œ ë©”íƒ€í¬ì¼ ë¿ì…ë‹ˆë‹¤.
{: .prompt-info }

### Netflixì˜ ìœ ì—°í•¨

ì´ ì•„í‚¤í…ì²˜ì˜ ì§„ê°€ëŠ” ì™¸ë¶€ ì‹œìŠ¤í…œì„ êµì²´í•  ë•Œ ë“œëŸ¬ë‚©ë‹ˆë‹¤. ë„·í”Œë¦­ìŠ¤(Netflix) ì—”ì§€ë‹ˆì–´ë§ íŒ€ì€ ìŠ¤íŠœë””ì˜¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì— í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•˜ì—¬ í° ì„±ê³µì„ ê±°ë‘ì—ˆìŠµë‹ˆë‹¤.

ê·¸ë“¤ì€ íŠ¹ì • ê¸°ëŠ¥ì˜ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ê¸°ì¡´ì˜ JSON APIì—ì„œ GraphQLë¡œ ë³€ê²½í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. ë§Œì•½ Layered ì•„í‚¤í…ì²˜ì˜€ë‹¤ë©´ ì„œë¹„ìŠ¤ ë¡œì§ì„ ëŒ€ê±° ìˆ˜ì •í•´ì•¼ í–ˆì„ ê²ë‹ˆë‹¤. í•˜ì§€ë§Œ í—¥ì‚¬ê³ ë‚  êµ¬ì¡° ë•ë¶„ì—, ë„ë©”ì¸ ë¡œì§ì€ ë‹¨ í•œ ì¤„ë„ ìˆ˜ì •í•˜ì§€ ì•Šê³ , ìƒˆë¡œìš´ Secondary Adapter(Driven Adapter)ë¥¼ ê°ˆì•„ ë¼ìš°ëŠ” ê²ƒë§Œìœ¼ë¡œ ë‹¨ 2ì‹œê°„ ë§Œì— ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ í¬íŠ¸ì™€ ì–´ëŒ‘í„°ê°€ ì£¼ëŠ” ê°•ë ¥í•œ ìœ ì—°í•¨ì…ë‹ˆë‹¤.

### ë§¤í•‘ ì§€ì˜¥

í•˜ì§€ë§Œ ëª¨ë“  ì„ íƒì—ëŠ” ëŒ€ê°€ê°€ ë”°ë¦…ë‹ˆë‹¤. ë„ë©”ì¸ì˜ ìˆœìˆ˜ì„±(Purity)ì„ ì§€í‚¤ê¸° ìœ„í•´ ìš°ë¦¬ê°€ ì§€ë¶ˆí•´ì•¼ í•  ë¹„ìš©ì€ ë°”ë¡œ ì¸ì§€ ë¶€í•˜(Cognitive Load)ì™€ ë§¤í•‘ ë¹„ìš©ì…ë‹ˆë‹¤.

ë‹¨ìˆœí•œ ë°ì´í„° ì €ì¥ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ë°ì´í„°ê°€ ê±°ì³ì•¼ í•˜ëŠ” ì—¬ì •ì„ ì‚´í´ë´…ì‹œë‹¤.
1. **Web DTO** (`UserController`ê°€ ë°›ìŒ)
2. **Command ê°ì²´** (Input Portë¡œ ë³€í™˜)
3. **Domain Entity** (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰)
4. **JPA Entity** (Output Portë¥¼ ê±°ì³ DB ì €ì¥ìš©ìœ¼ë¡œ ë³€í™˜)

í•„ë“œ í•˜ë‚˜ë¥¼ ì¶”ê°€í•˜ë ¤ë©´ 4~5ê°œì˜ í´ë˜ìŠ¤ë¥¼ ìˆ˜ì •í•˜ê³ , ì´ë“¤ ì‚¬ì´ë¥¼ ì—°ê²°í•˜ëŠ” ì§€ë£¨í•œ ë§¤í•‘(Mapping) ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ê°œë°œìë“¤ì€ ìì¡° ì„ì¸ ëª©ì†Œë¦¬ë¡œ ë§¤í•‘ ì§€ì˜¥(Mapping Hell)ì´ë¼ ë¶€ë¦…ë‹ˆë‹¤.

ë„·í”Œë¦­ìŠ¤ì™€ ê°™ì´ ë³µì¡í•œ í•µì‹¬ ë„ë©”ì¸(Core Domain)ì—ëŠ” ì´ ë¹„ìš©ì´ ì •ë‹¹í™”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë‹¨ìˆœí•œ CRUDê°€ ì£¼ë¥¼ ì´ë£¨ëŠ” ì‹œìŠ¤í…œì—ì„œ í—¥ì‚¬ê³ ë‚ ì„ ë„ì…í•˜ëŠ” ê²ƒì€ ëª…ë°±í•œ ì˜¤ë²„ ì—”ì§€ë‹ˆì–´ë§ì…ë‹ˆë‹¤.

## ğŸ§© Vertical Slice Architecture

Layeredì™€ Hexagonalì€ ê²‰ë³´ê¸°ì—” ë‹¬ë¼ ë³´ì´ì§€ë§Œ, ê·¼ë³¸ì ì¸ ê³µí†µì ì´ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ ì½”ë“œë¥¼ ê¸°ìˆ ì  ê³„ì¸µ(Horizontal Layers)ì— ë”°ë¼ ë‚˜ëˆˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤.

ì§€ë¯¸ ë³´ê°€ë“œ(Jimmy Bogard)ëŠ” ì—¬ê¸°ì„œ ê·¼ë³¸ì ì¸ ì˜ë¬¸ì„ ì œê¸°í•©ë‹ˆë‹¤.

> "ìš°ë¦¬ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•  ë•Œ UI, ë¡œì§, DBë¥¼ ëª¨ë‘ ê±´ë“œë¦°ë‹¤. ì¦‰, ë³€ê²½ì€ ìˆ˜ì§(Vertical)ìœ¼ë¡œ ì¼ì–´ë‚˜ëŠ”ë°, ì™œ ì½”ë“œëŠ” ìˆ˜í‰(Horizontal)ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ”ê°€?"

ì´ëŸ¬í•œ ë¬¸ì œì˜ì‹ì—ì„œ ì¶œë°œí•œ ê²ƒì´ ë°”ë¡œ Vertical Slice Architectureì…ë‹ˆë‹¤.

### ë³€ê²½ì˜ ì¶•ì„ ë”°ë¥´ë¼

ì´ ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ì€ ì‘ì§‘ë„ì˜ ì¬ì •ì˜ì…ë‹ˆë‹¤.

ì „í†µì ì¸ ê´€ì ì—ì„œ ì‘ì§‘ë„ëŠ” ê°™ì€ ì¢…ë¥˜ì˜ ì½”ë“œ(Controllerë¼ë¦¬, Serviceë¼ë¦¬)ë¥¼ ëª¨ìœ¼ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Vertical SliceëŠ” í•¨ê»˜ ë³€ê²½ë˜ëŠ” ì½”ë“œë¥¼ ëª¨ìœ¼ëŠ” ê²ƒì´ ì§„ì •í•œ ì‘ì§‘ë„ë¼ê³  ì£¼ì¥í•©ë‹ˆë‹¤.
- Before (Layered): `User` ê´€ë ¨ ê¸°ëŠ¥ì„ ìˆ˜ì •í•˜ë ¤ë©´ `controller` íŒ¨í‚¤ì§€, `service` íŒ¨í‚¤ì§€, `repository` íŒ¨í‚¤ì§€ë¥¼ ì˜¤ë¥´ë‚´ë¦¬ë©° íƒìƒ‰í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. (Low Cohesion)
- After (Slice): `features/registerUser` íŒ¨í‚¤ì§€ ì•ˆì— `Controller`, `Command`, `Validator`, `Repository`ê°€ ëª¨ë‘ ëª¨ì—¬ ìˆìŠµë‹ˆë‹¤.

ì´ì œ ê°œë°œìëŠ” ê¸°ëŠ¥ì„ ìˆ˜ì •í•˜ê¸° ìœ„í•´ í”„ë¡œì íŠ¸ íƒìƒ‰ê¸°ë¥¼ í—¤ë§¬ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ê´€ë ¨ëœ ëª¨ë“  ë¬¸ë§¥ì´ í•˜ë‚˜ì˜ í´ë”(Slice) ì•ˆì— ê²©ë¦¬ë˜ì–´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë°ë¦­ ì½”ë§ˆí‹´(Derek Comartin)ì€ ì´ë¥¼ ë‘ê³  "ê¸°ìˆ ì  ê³„ì¸µì´ ì•„ë‹Œ ë¹„ì¦ˆë‹ˆìŠ¤ ì—­ëŸ‰ì— ë”°ë¥¸ ê²©ë¦¬"ë¼ê³  ê°•ì¡°í•©ë‹ˆë‹¤.

### íŒ¨í„´ìœ¼ë¡œì˜ ë¦¬íŒ©í† ë§

Vertical Sliceì˜ ê°€ì¥ ê°•ë ¥í•œ ë¬´ê¸°ëŠ” ìœ ì—°í•¨ì…ë‹ˆë‹¤. ëª¨ë“  ì½”ë“œê°€ íšì¼ì ì¸ êµ¬ì¡°ë¥¼ ê°€ì§ˆ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

ê° ìŠ¬ë¼ì´ìŠ¤ëŠ” ë¬¸ì œì˜ ë³µì¡ë„ì— ë”°ë¼ ìµœì ì˜ êµ¬í˜„ ë°©ì‹ì„ ì„ íƒí•  ê¶Œë¦¬ë¥¼ ê°€ì§‘ë‹ˆë‹¤.
- ë‹¨ìˆœ ì¡°íšŒ (Simple Query): ë³µì¡í•œ ë„ë©”ì¸ ëª¨ë¸ì´ë‚˜ DTO ë³€í™˜ ì—†ì´, `Controller`ê°€ `JdbcTemplate`ì´ë‚˜ `Raw SQL`ì„ ì§ì ‘ í˜¸ì¶œí•˜ì—¬ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤. (Layered ì•„í‚¤í…ì²˜ì˜€ë‹¤ë©´ 'ìƒˆì¹˜ê¸°'ë¼ê³  ë¹„ë‚œë°›ì•˜ì„ êµ¬ì¡°ì…ë‹ˆë‹¤.)
- ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ (Complex Command): `Rich Domain Model`ì„ ì‚¬ìš©í•˜ì—¬ ì—„ê²©í•œ ìº¡ìŠí™”ì™€ í…ŒìŠ¤íŠ¸ë¥¼ ì ìš©í•©ë‹ˆë‹¤.

ë¶ˆí•„ìš”í•œ ì¶”ìƒí™”ë¥¼ ê±·ì–´ë‚´ê³ , ê° ê¸°ëŠ¥ì˜ íŠ¹ì„±ì— ë§ëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ìš©ì„±ì„ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.

### ì¤‘ë³µì„ í—ˆìš©í•˜ë¼

ê·¸ë ‡ë‹¤ë©´ ê³µí†µ ë¡œì§ì´ë‚˜ ì¤‘ë³µ ì½”ë“œëŠ” ì–´ë–»ê²Œ í• ê¹Œìš”? Vertical SliceëŠ” ì´ì— ëŒ€í•´ ë‹¤ì†Œ íŒŒê²©ì ì¸ ë‹µì„ ë‚´ë†“ìŠµë‹ˆë‹¤.

> "ìš°ë°œì  ì¤‘ë³µ(Accidental Duplication)ì„ í—ˆìš©í•˜ë¼."

ìš°ë¦¬ëŠ” ìŠµê´€ì ìœ¼ë¡œ `SharedService`ë‚˜ `CommonDTO`ë¥¼ ë§Œë“¤ì–´ ì¤‘ë³µì„ ì œê±°í•˜ë ¤ í•©ë‹ˆë‹¤(DRY ì›ì¹™). í•˜ì§€ë§Œ ì„œë¡œ ë‹¤ë¥¸ ë³€ê²½ ì£¼ê¸°ë¥¼ ê°€ì§„ ë‘ ê¸°ëŠ¥ì´ í•˜ë‚˜ì˜ ê³µí†µ ì½”ë“œì— ë¬¶ì´ëŠ” ìˆœê°„, ìš°ë°œì  ê²°í•©(Accidental Coupling)ì´ ë°œìƒí•©ë‹ˆë‹¤. A ê¸°ëŠ¥ì„ ìœ„í•´ ê³µí†µ ì½”ë“œë¥¼ ìˆ˜ì •í–ˆëŠ”ë°, B ê¸°ëŠ¥ì´ ë§ê°€ì§€ëŠ” ìƒí™©ì´ ë²Œì–´ì§€ëŠ” ê²ƒì…ë‹ˆë‹¤.

Vertical SliceëŠ” ì„£ë¶€ë¥¸ ê³µí†µí™”ë³´ë‹¤ëŠ”, ì•½ê°„ì˜ ë³µì‚¬-ë¶™ì—¬ë„£ê¸°(Copy-Paste)ë¥¼ ê°ìˆ˜í•˜ë”ë¼ë„ ì™„ë²½í•œ ê²©ë¦¬ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ ì¥ê¸°ì ì¸ ìœ ì§€ë³´ìˆ˜ì— ìœ ë¦¬í•˜ë‹¤ê³  ë´…ë‹ˆë‹¤. ì½”ë“œë¥¼ ê³µìœ í•˜ëŠ” ê²ƒë³´ë‹¤, ì§€ì‹ì„ ê³µìœ í•˜ëŠ” ê²ƒì´ ë” ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

## Architecture as Code

ì•„ë¬´ë¦¬ ì™„ë²½í•œ ì•„í‚¤í…ì²˜ë¥¼ ì„¤ê³„í•´ë„, ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì½”ë“œëŠ” ì—‰í‚¤ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ë¬¸ì„œëŠ” ì½”ë“œë¥¼ ì´ê¸¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì•„í‚¤í…ì²˜ ì œì•½ì¡°ê±´ì€ ê°œë°œìì˜ ê¸°ì–µì´ ì•„ë‹Œ, ì‹¤íŒ¨í•˜ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(Failing Unit Test)ë¡œ ê´€ë¦¬ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

ìë°” ì§„ì˜ì˜ ArchUnitì€ ì»´íŒŒì¼ëœ ë°”ì´íŠ¸ì½”ë“œ(Bytecode)ë¥¼ ë¶„ì„í•˜ì—¬ ì˜ì¡´ì„± ê·œì¹™ì„ ê²€ì¦í•˜ëŠ” ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤.

### Layered Architecture: 'ìƒˆì¹˜ê¸°' ë°©ì§€

Layered ì•„í‚¤í…ì²˜ê°€ ë¬´ë„ˆì§€ëŠ” ê°€ì¥ í”í•œ íŒ¨í„´ì€ ê³„ì¸µ ê±´ë„ˆë›°ê¸°(Bypass)ì…ë‹ˆë‹¤. `Controller`ê°€ `Service`ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  `Repository`ë¥¼ ì§ì ‘ ì£¼ì…ë°›ì•„ ì‚¬ìš©í•˜ëŠ” ìˆœê°„, íŠ¸ëœì­ì…˜ ê´€ë¦¬ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ìº¡ìŠí™”ëŠ” ê¹¨ì§‘ë‹ˆë‹¤.

ì´ë¥¼ ë¦¬ë·° ë‹¨ê³„ì—ì„œ ëˆˆìœ¼ë¡œ ì¡ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥ì— ê°€ê¹ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì½”ë“œë¡œ ì •ì˜í•˜ë©´ ë¹Œë“œ íƒ€ì„ì— ì¡ì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
@AnalyzeClasses(packages = "com.teno.lab")
public class LayeredArchitectureTest {

    @ArchTest
    static final ArchRule layer_boundaries_are_respected = layeredArchitecture()
            .consideringOnlyDependenciesInLayers()
            // 1. ë ˆì´ì–´ ì •ì˜: íŒ¨í‚¤ì§€ êµ¬ì¡°ì™€ ë§¤í•‘
            .layer("Controller").definedBy("..controller..")
            .layer("Service").definedBy("..service..")
            .layer("Repository").definedBy("..repository..")

            // 2. ì œì•½ ì¡°ê±´: í™”ì‚´í‘œëŠ” ìœ„ì—ì„œ ì•„ë˜ë¡œë§Œ íë¥¸ë‹¤
            .whereLayer("Controller").mayNotBeAccessedByAnyLayer()
            .whereLayer("Service").mayOnlyBeAccessedByLayers("Controller")
            .whereLayer("Repository").mayOnlyBeAccessedByLayers("Service");
}
```

ì´ í…ŒìŠ¤íŠ¸ê°€ ì¡´ì¬í•˜ëŠ” í•œ, ëˆ„êµ°ê°€ ì‹¤ìˆ˜ë¡œ `Controller`ì— `Repository`ë¥¼ `import` í•˜ëŠ” ìˆœê°„ CI íŒŒì´í”„ë¼ì¸ì€ ë©ˆì¶¥ë‹ˆë‹¤.

### Vertical Slice Architecture: ê²©ë¦¬ì˜ ê²€ì¦

Vertical Slice ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ ë¦¬ìŠ¤í¬ëŠ” ìŠ¤íŒŒê²Œí‹° ì˜ì¡´ì„±ì…ë‹ˆë‹¤. ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ ì½”ë“œë¥¼ ëª¨ì•„ë‘ì—ˆëŠ”ë°, A ê¸°ëŠ¥ì´ B ê¸°ëŠ¥ì˜ ë‚´ë¶€ í´ë˜ìŠ¤ë¥¼ ì°¸ì¡°í•˜ê¸° ì‹œì‘í•˜ë©´ ëª¨ë“ˆì„±ì€ íŒŒê´´ë©ë‹ˆë‹¤.

ArchUnitì˜ `SlicesRuleDefinition`ì„ ì‚¬ìš©í•˜ë©´ ìŠ¬ë¼ì´ìŠ¤ ê°„ì˜ ê²©ë¦¬ë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ ì¦ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
@AnalyzeClasses(packages = "com.teno.lab")
public class SliceArchitectureTest {

    @ArchTest
    static final ArchRule slices_should_be_free_of_cycles =
        SlicesRuleDefinition.slices()
            .matching("com.teno.lab.features.(*)..") // features í•˜ìœ„ íŒ¨í‚¤ì§€ë¥¼ í•˜ë‚˜ì˜ ìŠ¬ë¼ì´ìŠ¤ë¡œ ê°„ì£¼
            .should().beFreeOfCycles(); // ìˆœí™˜ ì°¸ì¡° ê¸ˆì§€
            
    @ArchTest
    static final ArchRule features_should_not_depend_on_other_features =
        classes().that().resideInAPackage("..features..")
            .should().onlyAccessClassesThat()
            .resideInAnyPackage("java..", "javax..", "..shared..", "..features.."); 
            // ë” ì—„ê²©í•˜ê²Œ Sharedì™€ JDK ì™¸ì—ëŠ” ì„œë¡œ ì°¸ì¡° ê¸ˆì§€ ì„¤ì • ê°€ëŠ¥
}
```

### Living Documentation

ì´ë ‡ê²Œ ì‘ì„±ëœ ì•„í‚¤í…ì²˜ í…ŒìŠ¤íŠ¸ëŠ” ê·¸ ìì²´ë¡œ ì‚´ì•„ìˆëŠ” ë¬¸ì„œ(Living Documentation)ê°€ ë©ë‹ˆë‹¤. ì—”ì§€ë‹ˆì–´ë§ì€ ë¯¿ìŒì´ ì•„ë‹ˆë¼ ì‹œìŠ¤í…œìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì•„í‚¤í…ì²˜ ë˜í•œ ì˜ˆì™¸ê°€ ì•„ë‹™ë‹ˆë‹¤.

## Summary

ëª¨ë“  ìƒí™©ì— ë§ëŠ” ì™„ë²½í•œ ì•„í‚¤í…ì²˜ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í”„ë¡œì íŠ¸ì˜ ì„±ê²©ê³¼ íŒ€ì˜ ìƒí™©ì— ë§ì¶° ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.

### Selection Criteria

| Architecture   | Best Fit For                                          | Key Constraint                                |
| -------------- | ----------------------------------------------------- | --------------------------------------------- |
| Layered        | ì£¼ë‹ˆì–´ ìœ„ì£¼ íŒ€, ë‹¨ìˆœ CRUD, ë‹¨ê¸° í”„ë¡œì íŠ¸              | ë¹„ì¦ˆë‹ˆìŠ¤ ë³µì¡ë„ê°€ ì¦ê°€í•˜ë©´ ìœ ì§€ë³´ìˆ˜ ë¹„ìš© ê¸‰ì¦ |
| Hexagonal      | Core Subdomain, ì™¸ë¶€ ì‹œìŠ¤í…œ êµì²´ê°€ ì¦ì€ ì¥ê¸° í”„ë¡œì íŠ¸ | ë†’ì€ êµ¬í˜„ ë¹„ìš©, ë‹¨ìˆœ ê¸°ëŠ¥ì—ëŠ” ë¹„íš¨ìœ¨ì         |
| Vertical Slice | Agile í™˜ê²½, ê¸°ëŠ¥ ë³€ê²½ì´ ì¦ê³  ë³µì¡ë„ í¸ì°¨ê°€ í° ê²½ìš°    | íŒ€ì›ë“¤ì˜ ë†’ì€ ì½”ë“œ ë¦¬íŒ©í† ë§ ì—­ëŸ‰ ìš”êµ¬         |

### Hybrid Modular Monolith

ì‹¤ë¬´ì—ì„œëŠ” í•˜ì´ë¸Œë¦¬ë“œ ì „ëµì´ ìœ íš¨í•©ë‹ˆë‹¤. ì „ì²´ ì‹œìŠ¤í…œì„ ëª¨ë“ˆí˜• ëª¨ë†€ë¦¬ìŠ¤(Modular Monolith)ë¡œ êµ¬ì„±í•˜ë˜, ëª¨ë“ˆì˜ ì¤‘ìš”ë„ì— ë”°ë¼ ë‚´ë¶€ ì•„í‚¤í…ì²˜ë¥¼ ë‹¬ë¦¬ ê°€ì ¸ê°€ëŠ” ê²ƒì…ë‹ˆë‹¤.

> ë¹„ì¦ˆë‹ˆìŠ¤ì˜ ì •ìˆ˜ê°€ ë‹´ê¸´ í•µì‹¬ ëª¨ë“ˆ(Core Module)ì€ í—¥ì‚¬ê³ ë‚ ë¡œ ë°©ì–´í•˜ê³ , ë‹¨ìˆœ ì§€ì›ì´ë‚˜ ì¡°íšŒ ìœ„ì£¼ì˜ ì„œë¸Œ ëª¨ë“ˆì€ ë²„í‹°ì»¬ ìŠ¬ë¼ì´ìŠ¤ë¡œ ìƒì‚°ì„±ì„ í™•ë³´í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì¼ê´€ì„±ë³´ë‹¤ ì‹¤ìš©ì„±ì´ ìš°ì„ ì…ë‹ˆë‹¤.
{: .prompt-tip }

## References

* [[Martin Fowler] Presentation Domain Data Layering](https://martinfowler.com/bliki/PresentationDomainDataLayering.html)
* [[Alistair Cockburn] Hexagonal Architecture](https://alistair.cockburn.us/hexagonal-architecture)
* [[Netflix TechBlog] Ready for changes with Hexagonal Architecture](https://netflixtechblog.com/ready-for-changes-with-hexagonal-architecture-b315ec967749)
* [[Jimmy Bogard] Vertical Slice Architecture](https://www.jimmybogard.com/vertical-slice-architecture/)
* [[CodeOpinion] Vertical Slice Architecture isn't technical](https://codeopinion.com/vertical-slice-architecture-isnt-technical/)